import{r as o,u as B,b as X,j as t,a as W}from"./index-BTUQfSWa.js";import{F as L}from"./FileUpload-CeNdxQgG.js";import{R as z}from"./ResultView-BWtcuH1S.js";const Q=({onSelectService:E})=>{const[r,p]=o.useState(null),[c,u]=o.useState(!1),[f,n]=o.useState(""),[k,a]=o.useState(""),[x,d]=o.useState(null),{setStagedFile:g}=B(),w=e=>{if(e.length>0){const s=e[0];["application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(s.type)?(p(s),d(null),n("")):n("الرجاء اختيار ملف DOCX فقط.")}},F=async()=>{if(!r){n("الرجاء اختيار ملف أولاً.");return}u(!0),n(""),a("جاري استخراج النص من ملف Word...");try{const e=await r.arrayBuffer(),{value:s}=await mammoth.extractRawText({arrayBuffer:e});if(!s)throw new Error("لم يتمكن من استخراج أي نص من الملف.");a("جاري إنشاء ملف PDF...");const{PDFDocument:b,rgb:S}=PDFLib,l=await b.create();l.registerFontkit(fontkit);const C=await fetch("https://fonts.gstatic.com/s/cairo/v28/SLXgc1nY6HkvangtZmpQdkh-SCpsapi-.ttf").then(P=>P.arrayBuffer()),y=await l.embedFont(C);let i=l.addPage();const{width:R,height:N}=i.getSize(),h=12,m=50;let j=N-m;const $=s.split(`
`);for(const P of $){const U=y.widthOfTextAtSize(P,h);j<m&&(i=l.addPage(),j=N-m),i.drawText(P,{x:R-m-U,y:j,font:y,size:h,color:S(0,0,0)}),j-=h+5}const I=await l.save(),O=new File([I],`${r.name.split(".")[0]}.pdf`,{type:"application/pdf"});d(O)}catch(e){n("حدث خطأ أثناء تحويل الملف."),console.error(e)}finally{u(!1),a("")}},v=()=>{p(null),d(null),n("")},D=(e,s)=>{g(s),E(e)};if(x){const e=X.filter(s=>["compress","protect","merge","split","edit","sign-pdf"].includes(s.id));return t.jsx(z,{title:"اكتمل التحويل إلى PDF بنجاح!",file:x,onReset:v,nextSteps:e,onNextStep:D})}return t.jsx("div",{className:"max-w-3xl mx-auto bg-white dark:bg-slate-800 p-8 rounded-xl shadow-lg",children:t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx(L,{onFileSelect:w,acceptedFileTypes:".docx",promptText:r?r.name:"اسحب وأفلت ملف DOCX هنا أو انقر للاختيار"}),t.jsxs("div",{className:"mt-4 text-sm text-slate-600 dark:text-slate-300 bg-amber-100 dark:bg-amber-900/50 border-r-4 border-amber-400 p-3 rounded-md",children:[t.jsx("strong",{children:"ملاحظة:"})," سيتم تحويل المحتوى النصي فقط. قد يتم فقدان التنسيقات المعقدة والصور والجداول."]}),t.jsx("button",{id:"primary-action-button",title:"Cmd/Ctrl + Enter",onClick:F,disabled:c||!r,className:"mt-6 bg-blue-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-blue-700 transition-colors disabled:bg-slate-400 disabled:cursor-not-allowed flex items-center justify-center w-48",children:c?t.jsx(W,{}):"تحويل الآن"}),c&&t.jsx("p",{className:"mt-4 text-slate-600 dark:text-slate-300",role:"status",children:k}),f&&t.jsx("p",{role:"alert",className:"mt-4 text-red-500 bg-red-100 dark:bg-red-900/50 dark:text-red-300 p-3 rounded-md w-full text-center",children:f})]})})},Y=({onSelectService:E})=>{const[r,p]=o.useState(null),[c,u]=o.useState(!1),[f,n]=o.useState(""),[k,a]=o.useState(""),[x,d]=o.useState(null),{stagedFile:g,setStagedFile:w}=B();o.useEffect(()=>{g&&(F([g]),w(null))},[g,w]);const F=e=>{if(e.length>0){const s=e[0];s.type==="application/pdf"?(p(s),d(null),n("")):n("الرجاء اختيار ملف PDF فقط.")}},v=async()=>{if(!r){n("الرجاء اختيار ملف أولاً.");return}u(!0),n(""),a("جاري قراءة ملف PDF...");try{const e=window.docx;if(!e||!e.Document||!e.Paragraph||!e.Packer)throw new Error("مكتبة تصدير Word غير متاحة أو لم يتم تحميلها بالكامل. يرجى التحقق من اتصالك بالإنترنت وتحديث الصفحة.");const s=await r.arrayBuffer(),b=await pdfjsLib.getDocument(s).promise,S=b.numPages,l=[];for(let i=1;i<=S;i++){a(`جاري معالجة الصفحة ${i} من ${S}...`);const h=(await(await b.getPage(i)).getTextContent()).items.map(m=>m.str).join(" ");l.push(new e.Paragraph({text:h,bidirectional:!0}))}a("جاري إنشاء مستند Word...");const T=new e.Document({sections:[{children:l}]}),C=await e.Packer.toBlob(T),y=new File([C],`${r.name.split(".")[0]}.docx`,{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});d(y)}catch(e){const s=e instanceof Error?e.message:"حدث خطأ أثناء تحويل الملف. قد يكون الملف محميًا أو لا يحتوي على نص.";n(s),console.error(e)}finally{u(!1),a("")}},D=()=>{p(null),d(null),n("")};return x?t.jsx(z,{title:"اكتمل التحويل إلى Word بنجاح!",file:x,onReset:D}):t.jsx("div",{className:"max-w-3xl mx-auto bg-white dark:bg-slate-800 p-8 rounded-xl shadow-lg",children:t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx(L,{onFileSelect:F,acceptedFileTypes:".pdf",promptText:r?r.name:"اسحب وأفلت ملف PDF هنا أو انقر للاختيار"}),t.jsxs("div",{className:"mt-4 text-sm text-slate-600 dark:text-slate-300 bg-amber-100 dark:bg-amber-900/50 border-r-4 border-amber-400 p-3 rounded-md",children:[t.jsx("strong",{children:"ملاحظة:"})," سيتم تحويل المحتوى النصي فقط. قد يتم فقدان التنسيقات المعقدة والصور والجداول."]}),t.jsx("button",{id:"primary-action-button",title:"Cmd/Ctrl + Enter",onClick:v,disabled:c||!r,className:"mt-6 bg-blue-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-blue-700 transition-colors disabled:bg-slate-400 disabled:cursor-not-allowed flex items-center justify-center w-48",children:c?t.jsx(W,{}):"تحويل الآن"}),c&&t.jsx("p",{className:"mt-4 text-slate-600 dark:text-slate-300",role:"status",children:k}),f&&t.jsx("p",{role:"alert",className:"mt-4 text-red-500 bg-red-100 dark:bg-red-900/50 dark:text-red-300 p-3 rounded-md w-full text-center",children:f})]})})};export{Y as P,Q as W};
